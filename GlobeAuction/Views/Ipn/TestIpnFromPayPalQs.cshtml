@model GlobeAuction.Models.BidderForPayPal

@{
    ViewBag.Title = "PayPal Exampple IPN";
}

@using (Html.BeginForm("Receive", "Ipn", FormMethod.Post, new { id = "ipnForm" }))
{
    <input type="submit" name="Submit" />
}


<script type='text/javascript'>
    var qs = 'txn_type=new_case&payment_date=16:37:47 Mar 25, 2017 PDT&case_id=PP-005-678-384-813&case_type=dispute&business=treasurer.globeacademy@gmail.com&verify_sign=AFcWxV21C7fd0v3bYYYRCpSSRl31AEE6RbZPn9n3yr7GqVjfnIGy9vI6&payer_email=iain@freshtix.com&txn_id=2303981788815841E&case_creation_date=06:43:27 Mar 28, 2017 PDT&receiver_email=treasurer.globeacademy@gmail.com&buyer_additional_information=It was good to see you at the Auction briefly. Congrats. I know how hard you worked on that!&payer_id=TKW8ZP6MJXXTA&receiver_id=Z6MBQ8R8TQ64A&reason_code=non_receipt&custom=Bidder:414&charset=windows-1252&notify_version=3.8&ipn_track_id=2e01dcb38553b';

    $("#ipnForm").submit(function (eventObj) {

        var fieldArray = qs.split('&');

        for (i = 0; i < fieldArray.length; i++) {
            var field = fieldArray[i];
            var parts = field.split('=');
            var name = parts[0];
            var value = parts[1];
            
            $('<input />').attr('type', 'hidden')
                .attr('name', name)
                .attr('value', value)
                .appendTo(this);
        }

        return true;
    });
</script>